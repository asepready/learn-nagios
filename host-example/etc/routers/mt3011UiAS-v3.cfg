##  Configuration SNMP Host MikroTik
/snmp community
set [ find default=yes ] addresses=192.168.10.0/24 \
    authentication-password="YUkVXTnIBBlGvOeU" \
    authentication-protocol=MD5 encryption-password=\
    "dcyoioisdjRalrUN" encryption-protocol=DES name=\
    public security=private write-access=no

/snmp
set contact=mikrotik.com enabled=yes engine-id="" location=mikrotik.com \
    trap-community="public" trap-generators="" trap-target="" trap-version=3

/ip firewall filter
add action=accept chain=input comment="snmp-udp" dst-port=161 protocol=udp
add action=accept chain=input comment="snmp-udp" dst-port=162 protocol=udp
##########################################################################

define host {
    use                     generic-switch
    host_name               router-gateway
    alias                   Router Gateway Dinas Komunikasi & Informatika
    notes                   Router Gateway Dinas Komunikasi & Informatika
    parents                 firewall
    address                 192.168.10.1
}

define service {
    use                     generic-service 
    host_name               router-gateway
    service_description     PING
    check_command           check_ping!200.0,20%!600.0,60%
    check_interval          5
    retry_interval          1
}

define service {
    use                     generic-service
    host_name               router-gateway
    service_description     Router Model
    check_command           check_snmpv3!sysDescr.0!public!authPriv!public!YUkVXTnIBBlGvOeU!dcyoioisdjRalrUN
}

define service {
    use                     generic-service
    host_name               router-gateway
    service_description     Uptime
    check_command           check_snmp! -o sysUpTime.0 -C public -P 2c
    check_command           check_snmpv3!sysUpTime.0!public!authPriv!public!YUkVXTnIBBlGvOeU!dcyoioisdjRalrUN
}

define service {
    use                     generic-service
    host_name               router-gateway
    service_description     Total Services Running
    check_command           check_snmpv3!sysServices.0!public!authPriv!public!YUkVXTnIBBlGvOeU!dcyoioisdjRalrUN
}

define service {
    use                     generic-service
    host_name               router-gateway
    service_description     DHCP Lease Count
    check_command           check_snmpv3!1.3.6.1.4.1.14988.1.1.6.1.0!public!authPriv!public!YUkVXTnIBBlGvOeU!dcyoioisdjRalrUN 
}

define service {
    use                     generic-service
    host_name               router-gateway
    service_description     CPU Usage
    check_command           check_snmp_load! -l public -x YUkVXTnIBBlGvOeU -X dcyoioisdjRalrUN -L md5,des -T stand -w 90 -c 95
}

define service {
    use                     generic-service                     ; Inherit values from a template
    host_name               router-gateway
    service_description     Ether11 Link Status
    check_command           check_snmpv3!ifOperStatus.1!public!authPriv!public!YUkVXTnIBBlGvOeU!dcyoioisdjRalrUN -r 1 -m RFC1213-MIB
}

define service{
    use                     local-service  
    host_name               router-gateway
    service_description     Ether11 Bandwidth Usage
    check_command           check_local_mrtgtraf!/var/www/mrtg/192.168.10.1_moratel_(ether_11).log!AVG!1000000,1000000!5000000,5000000!5
}

############################# Tests #################################
./check_snmp -H 192.168.10.1 -o 1.3.6.1.4.1.14988.1.1.6.1.0  -C public -t 2 -p 161 -P 3 -L authPriv -U public -a MD5 -A YUkVXTnIBBlGvOeU -x DES -X dcyoioisdjRalrUN

./check_snmp -H 192.168.10.1 -o ifOperStatus.1  -C public -t 2 -p 161 -P 3 -L authPriv -U public -a MD5 -A YUkVXTnIBBlGvOeU -x DES -X dcyoioisdjRalrUN -r 1 -m RFC1213-MIB

SNMP CRITICAL - *6* | RFC1213-MIB::ifOperStatus.1=6 

snmpwalk -v3 -a MD5 -A YUkVXTnIBBlGvOeU -x DES -X dcyoioisdjRalrUN -l authPriv -u public 192.168.10.1 | head
